ctTable8 <- read.csv(paste(dataDir, "RAD003(p1220p1321).csv.trimmed", sep=""),
header=TRUE, stringsAsFactors=FALSE)
ctTable8$probe <- "RAD003"
View(ctTable6)
View(ctTable7)
View(ctTable8)
ctTable9 <- read.csv(paste(dataDir, "1362292377-TEY006-TEY014.csv.trimmed", sep=""),
header=TRUE, stringsAsFactors=FALSE)
ctTable9$probe <- "TEY6"
ctTable10 <- read.csv(paste(dataDir, "1362356331-RAD004-TEY013.csv.trimmed", sep=""),
header=TRUE, stringsAsFactors=FALSE)
ctTable10 <- subset(ctTable10, grepl("TEY013", ctTable10$Name, fixed = TRUE))
ctTable10$probe <- "TEY013"
ctTable10 <- read.csv(paste(dataDir, "1362356331-RAD004-TEY013.csv.trimmed", sep=""),
header=TRUE, stringsAsFactors=FALSE)
View(ctTable10)
ctTable10 <- subset(ctTable10, grepl("TEY", ctTable10$Name, fixed = TRUE))
ctTable10$probe <- "TEY013"
View(ctTable10)
ctTable11 <- read.csv(paste(dataDir, "1362351434-processedresults-TNET002.csv.trimmed", sep=""),
header=TRUE, stringsAsFactors=FALSE)
ctTable11$probe <- "TNET002"
ctTable12 <- read.csv(paste(dataDir, "1362351435_Processed-TNET001-UCM17.csv.trimmed", sep=""),
header=TRUE, stringsAsFactors=FALSE)
ctTable12 <- subset(ctTable12, grepl("TNET001", ctTable12$Name, fixed = TRUE))
ctTable12$probe <- "TNET001"
ctTable13 <- read.csv(paste(dataDir, "1362351436_Processed-TNET003.csv.trimmed", sep=""),
header=TRUE, stringsAsFactors=FALSE)
ctTable13$probe <- "TNET003"
ctTable14 <- read.csv(paste(dataDir, "1362351439-TNET004-Plate1.csv.trimmed", sep=""),
header=TRUE, stringsAsFactors=FALSE)
ctTable14$probe <- "TNET004"
ctTable15 <- read.csv(paste(dataDir, "1362351440-TNET004-Plate2.csv.trimmed", sep=""),
header=TRUE, stringsAsFactors=FALSE)
ctTable16$probe <- "TNET004"
ctTable15$probe <- "TNET004"
ctTableCombine <- rbind(ctTable1, ctTable2, ctTable3, ctTable4, ctTable5, ctTable6, ctTable7, ctTable8,
ctTable9, ctTable10, ctTable11, ctTable12, ctTable13, ctTable14, ctTable15)
## change column names
names(ctTableCombine)[c(2, 5, 7)] <- c("cellType", "gene", "ct")
## Creat and name cellSource (cohort) column value
ctTableCombine$cellSource <- NA
ctTableCombine[grepl("RAD", ctTableCombine$cellType, fixed=TRUE), "cellSource"] <- "Child"
ctTableCombine[grepl("TEY", ctTableCombine$cellType, fixed=TRUE), "cellSource"] <- "Adult"
ctTableCombine[grepl("TNET", ctTableCombine$cellType, fixed=TRUE), "cellSource"] <- "Risk"
ctTableCombine[grepl("EMPTY", ctTableCombine$cellType, fixed=TRUE), "cellSource"] <- "control"
ctTable1 <- read.csv(paste(dataDir, "1362015470-RAD001-FrozenvsFresh.csv.trimmed", sep=""),
header=TRUE, stringsAsFactors=FALSE)
ctTable1$probe <- "RAD1"
ctTable2 <- read.csv(paste(dataDir, "RAD003.csv.trimmed", sep=""),
header=TRUE, stringsAsFactors=FALSE)
ctTable2$probe <- "RAD3"
ctTable3 <- read.csv(paste(dataDir, "1362351438-RAD006.csv.trimmed", sep=""),
header=TRUE, stringsAsFactors=FALSE)
ctTable3$probe <- "RAD6"
ctTable4 <- read.csv(paste(dataDir, "1362351437-Processed_RAD005.csv.trimmed", sep=""),
header=TRUE, stringsAsFactors=FALSE)
ctTable4$probe <- "RAD5"
ctTable5 <- read.csv(paste(dataDir, "1362356331-RAD004-TEY013.csv.trimmed", sep=""),
header=TRUE, stringsAsFactors=FALSE)
ctTable5$probe <- NA
for(i in 1:nrow(ctTable5)) {
if (grepl("RAD4", ctTable1[i,2], fixed=TRUE)){
ctTable1[i, "probe"] <- "RAD4"
}
if (grepl("RAD001", ctTable1[i,2], fixed=TRUE)){
ctTable1[i, "probe"] <- "RAD1"
}
}
ctTable6 <- read.csv(paste(dataDir, "1362356332-RAD003_Insulin_ICOS_PD1.csv.trimmed", sep=""),
header=TRUE, stringsAsFactors=FALSE)
ctTable6$probe <- "RAD3"
ctTable7 <- read.csv(paste(dataDir, "RAD001andRAD002.csv.trimmed", sep=""),
header=TRUE, stringsAsFactors=FALSE)
ctTable7$probe <- NA
for(i in 1:nrow(ctTable5)) {
if (grepl("RAD1", ctTable1[i,2], fixed=TRUE)){
ctTable1[i, "probe"] <- "RAD1"
}
if (grepl("RAD2", ctTable1[i,2], fixed=TRUE)){
ctTable1[i, "probe"] <- "RAD2"
}
}
ctTable8 <- read.csv(paste(dataDir, "RAD003(p1220p1321).csv.trimmed", sep=""),
header=TRUE, stringsAsFactors=FALSE)
ctTable8$probe <- "RAD3"
### read in Adults data
ctTable9 <- read.csv(paste(dataDir, "1362292377-TEY006-TEY014.csv.trimmed", sep=""),
header=TRUE, stringsAsFactors=FALSE)
ctTable9$probe <- "TEY6"
ctTable10 <- read.csv(paste(dataDir, "1362356331-RAD004-TEY013.csv.trimmed", sep=""),
header=TRUE, stringsAsFactors=FALSE)
ctTable10 <- subset(ctTable10, grepl("TEY", ctTable10$Name, fixed = TRUE))
ctTable10$probe <- NA
for(i in 1:nrow(ctTable5)) {
if (grepl("TEY003", ctTable1[i,2], fixed=TRUE)){
ctTable1[i, "probe"] <- "TEY3"
}
if (grepl("TEY008", ctTable1[i,2], fixed=TRUE)){
ctTable1[i, "probe"] <- "TEY8"
}
}
### read in At_Ristk data
ctTable11 <- read.csv(paste(dataDir, "1362351434-processedresults-TNET002.csv.trimmed", sep=""),
header=TRUE, stringsAsFactors=FALSE)
ctTable11$probe <- "TNET002"
ctTable12 <- read.csv(paste(dataDir, "1362351435_Processed-TNET001-UCM17.csv.trimmed", sep=""),
header=TRUE, stringsAsFactors=FALSE)
ctTable12 <- subset(ctTable12, grepl("TNET001", ctTable12$Name, fixed = TRUE))
ctTable12$probe <- "TNET001"
ctTable13 <- read.csv(paste(dataDir, "1362351436_Processed-TNET003.csv.trimmed", sep=""),
header=TRUE, stringsAsFactors=FALSE)
ctTable13$probe <- "TNET003"
ctTable14 <- read.csv(paste(dataDir, "1362351439-TNET004-Plate1.csv.trimmed", sep=""),
header=TRUE, stringsAsFactors=FALSE)
ctTable14$probe <- "TNET004"
ctTable15 <- read.csv(paste(dataDir, "1362351440-TNET004-Plate2.csv.trimmed", sep=""),
header=TRUE, stringsAsFactors=FALSE)
ctTable15$probe <- "TNET004"
ctTable12 <- read.csv(paste(dataDir, "1362351435_Processed-TNET001-UCM17.csv.trimmed", sep=""),
header=TRUE, stringsAsFactors=FALSE)
View(ctTable12)
ctTable12 <- subset(ctTable12, grepl("TNet001", ctTable12$Name, fixed = TRUE))
ctTable12$probe <- "TNET001"
ctTableCombine <- rbind(ctTable1, ctTable2, ctTable3, ctTable4, ctTable5, ctTable6, ctTable7, ctTable8,
ctTable9, ctTable10, ctTable11, ctTable12, ctTable13, ctTable14, ctTable15)
names(ctTableCombine)[c(2, 5, 7)] <- c("cellType", "gene", "ct")
## Creat and name cellSource (cohort) column value
ctTableCombine$cellSource <- NA
ctTableCombine[grepl("RAD", ctTableCombine$cellType, fixed=TRUE), "cellSource"] <- "Child"
ctTableCombine[grepl("TEY", ctTableCombine$cellType, fixed=TRUE), "cellSource"] <- "Adult"
ctTableCombine[grepl("TNET", ctTableCombine$cellType, fixed=TRUE), "cellSource"] <- "Risk"
ctTableCombine[grepl("EMPTY", ctTableCombine$cellType, fixed=TRUE), "cellSource"] <- "control"
ctTable1 <- read.csv(paste(dataDir, "1362015470-RAD001-FrozenvsFresh.csv.trimmed", sep=""),
header=TRUE, stringsAsFactors=FALSE)
ctTable1$probe <- "RAD1"
ctTable2 <- read.csv(paste(dataDir, "RAD003.csv.trimmed", sep=""),
header=TRUE, stringsAsFactors=FALSE)
ctTable2$probe <- "RAD3"
ctTable3 <- read.csv(paste(dataDir, "1362351438-RAD006.csv.trimmed", sep=""),
header=TRUE, stringsAsFactors=FALSE)
ctTable3$probe <- "RAD6"
ctTable4 <- read.csv(paste(dataDir, "1362351437-Processed_RAD005.csv.trimmed", sep=""),
header=TRUE, stringsAsFactors=FALSE)
ctTable4$probe <- "RAD5"
ctTable5 <- read.csv(paste(dataDir, "1362356331-RAD004-TEY013.csv.trimmed", sep=""),
header=TRUE, stringsAsFactors=FALSE)
ctTable5$probe <- NA
ctTable5[grepl("RAD4", ctTable5$cellType, fixed=TRUE), "probe"] <- "RAD4"
ctTable5[grepl("RAD001", ctTable5$cellType, fixed=TRUE), "probe"] <- "RAD1"
ctTable6 <- read.csv(paste(dataDir, "1362356332-RAD003_Insulin_ICOS_PD1.csv.trimmed", sep=""),
header=TRUE, stringsAsFactors=FALSE)
ctTable6$probe <- "RAD3"
ctTable7 <- read.csv(paste(dataDir, "RAD001andRAD002.csv.trimmed", sep=""),
header=TRUE, stringsAsFactors=FALSE)
ctTable7$probe <- NA
ctTable7[grepl("RAD1", ctTable7$cellType, fixed=TRUE), "probe"] <- "RAD1"
ctTable7[grepl("RAD2", ctTable10$cellType, fixed=TRUE), "probe"] <- "RAD2"
ctTable8 <- read.csv(paste(dataDir, "RAD003(p1220p1321).csv.trimmed", sep=""),
header=TRUE, stringsAsFactors=FALSE)
ctTable8$probe <- "RAD3"
### read in Adults data
ctTable9 <- read.csv(paste(dataDir, "1362292377-TEY006-TEY014.csv.trimmed", sep=""),
header=TRUE, stringsAsFactors=FALSE)
ctTable9$probe <- "TEY6"
ctTable10 <- read.csv(paste(dataDir, "1362356331-RAD004-TEY013.csv.trimmed", sep=""),
header=TRUE, stringsAsFactors=FALSE)
ctTable10 <- subset(ctTable10, grepl("TEY", ctTable10$Name, fixed = TRUE))
ctTable10$probe <- NA
ctTable10[grepl("TEY003", ctTable10$cellType, fixed=TRUE), "probe"] <- "TEY3"
ctTable10[grepl("TEY008", ctTable10$cellType, fixed=TRUE), "probe"] <- "TEY8"
### read in At_Ristk data
ctTable11 <- read.csv(paste(dataDir, "1362351434-processedresults-TNET002.csv.trimmed", sep=""),
header=TRUE, stringsAsFactors=FALSE)
ctTable11$probe <- "TNET002"
ctTable12 <- read.csv(paste(dataDir, "1362351435_Processed-TNET001-UCM17.csv.trimmed", sep=""),
header=TRUE, stringsAsFactors=FALSE)
ctTable12 <- subset(ctTable12, grepl("TNet001", ctTable12$Name, fixed = TRUE))
ctTable12$probe <- "TNET001"
ctTable13 <- read.csv(paste(dataDir, "1362351436_Processed-TNET003.csv.trimmed", sep=""),
header=TRUE, stringsAsFactors=FALSE)
ctTable13$probe <- "TNET003"
ctTable14 <- read.csv(paste(dataDir, "1362351439-TNET004-Plate1.csv.trimmed", sep=""),
header=TRUE, stringsAsFactors=FALSE)
ctTable14$probe <- "TNET004"
ctTable15 <- read.csv(paste(dataDir, "1362351440-TNET004-Plate2.csv.trimmed", sep=""),
header=TRUE, stringsAsFactors=FALSE)
ctTable15$probe <- "TNET004"
## everything
ctTableCombine <- rbind(ctTable1, ctTable2, ctTable3, ctTable4, ctTable5, ctTable6, ctTable7, ctTable8,
ctTable9, ctTable10, ctTable11, ctTable12, ctTable13, ctTable14, ctTable15)
## change column names
names(ctTableCombine)[c(2, 5, 7)] <- c("cellType", "gene", "ct")
## Creat and name cellSource (cohort) column value
ctTableCombine$cellSource <- NA
ctTableCombine[grepl("RAD", ctTableCombine$cellType, fixed=TRUE), "cellSource"] <- "Child"
ctTableCombine[grepl("TEY", ctTableCombine$cellType, fixed=TRUE), "cellSource"] <- "Adult"
ctTableCombine[grepl("TNET", ctTableCombine$cellType, fixed=TRUE), "cellSource"] <- "Risk"
ctTableCombine[grepl("EMPTY", ctTableCombine$cellType, fixed=TRUE), "cellSource"] <- "control"
## load data
ctTable <- dataLoadT1D()
## set baseDir if Knitting with RStudio button
baseDir <- "~/Desktop/Su Lab/single_cell_T1D/"
## sets path if run from runAnalysis.R
#currentFile <- rstudioapi::getActiveDocumentContext()$path
#baseDir <- gsub("single_cell_T1D/.*", "single_cell_T1D/", currentFile)
#### source function scripts ####
funcDir <- paste(baseDir, "src/functions/", sep="")
funcFiles <- c("formatRaw.R",
"dataLoadT1D.R",
"cleanCt.R",
"geneSetEnrichment.R",
"violinPlot.R",
"heatmap2_custom.R",
"heatmap.3.R",
"clusterFilter.R",
"tableBarPlots.R",
"clusterReport.R",
"reportViolins.R",
"reportTSNE.R",
"plotTSNE.R")
funcFiles <- paste(funcDir, funcFiles, sep="")
for(file in funcFiles){
source(file)
}
## load data
ctTable <- dataLoadT1D()
View(ctTable)
library(plyr)
library(ggplot2)
library(RColorBrewer)
library(reshape2)
library(gplots)
library(gtools)
library(stats)
library(lattice)
library(latticeExtra)
library(grid)
library(gridExtra)
library(Rtsne)
## set baseDir if Knitting with RStudio button
baseDir <- "~/Desktop/Su Lab/single_cell_T1D/"
## sets path if run from runAnalysis.R
#currentFile <- rstudioapi::getActiveDocumentContext()$path
#baseDir <- gsub("single_cell_T1D/.*", "single_cell_T1D/", currentFile)
#### source function scripts ####
funcDir <- paste(baseDir, "src/functions/", sep="")
funcFiles <- c("formatRaw.R",
"dataLoadT1D.R",
"cleanCt.R",
"geneSetEnrichment.R",
"violinPlot.R",
"heatmap2_custom.R",
"heatmap.3.R",
"clusterFilter.R",
"tableBarPlots.R",
"clusterReport.R",
"reportViolins.R",
"reportTSNE.R",
"plotTSNE.R")
funcFiles <- paste(funcDir, funcFiles, sep="")
for(file in funcFiles){
source(file)
}
## load data
ctTable <- dataLoadT1D()
## set baseDir if Knitting with RStudio button
baseDir <- "~/Desktop/Su Lab/single_cell_T1D/"
## sets path if run from runAnalysis.R
#currentFile <- rstudioapi::getActiveDocumentContext()$path
#baseDir <- gsub("single_cell_T1D/.*", "single_cell_T1D/", currentFile)
#### source function scripts ####
funcDir <- paste(baseDir, "src/functions/", sep="")
funcFiles <- c("formatRaw.R",
"dataLoadT1D.R",
"cleanCt.R",
"geneSetEnrichment.R",
"violinPlot.R",
"heatmap2_custom.R",
"heatmap.3.R",
"clusterFilter.R",
"tableBarPlots.R",
"clusterReport.R",
"reportViolins.R",
"reportTSNE.R",
"plotTSNE.R")
funcFiles <- paste(funcDir, funcFiles, sep="")
for(file in funcFiles){
source(file)
}
## load data
ctTable <- dataLoadT1D()
View(ctTable)
knitr::opts_knit$set(global.par = TRUE)
library(plyr)
library(ggplot2)
library(RColorBrewer)
library(reshape2)
library(gplots)
library(gtools)
library(stats)
library(lattice)
library(latticeExtra)
library(grid)
library(gridExtra)
library(wesanderson)
library(Rtsne)
## set baseDir if Knitting with RStudio button
baseDir <- "~/Desktop/Su Lab/single_cell_T1D/"
## sets path if run from runAnalysis.R
#currentFile <- rstudioapi::getActiveDocumentContext()$path
#baseDir <- gsub("single_cell_T1D/.*", "single_cell_T1D/", currentFile)
#### source function scripts ####
funcDir <- paste(baseDir, "src/functions/", sep="")
funcFiles <- c("formatRaw.R",
"dataLoadT1D.R",
"cleanCt.R",
"geneSetEnrichment.R",
"violinPlot.R",
"heatmap2_custom.R",
"heatmap.3.R",
"clusterFilter.R",
"tableBarPlots.R",
"clusterReport.R",
"reportViolins.R",
"reportTSNE.R",
"plotTSNE.R")
funcFiles <- paste(funcDir, funcFiles, sep="")
for(file in funcFiles){
source(file)
}
## load data
ctTable <- dataLoadT1D()
## calculate log2Ex, reformat ctTable, and normalize values
ctNorm <- cleanCt(ctTable, summaryOutput=T, cumExpCutoff = F, normGene = "none")
View(ctNorm)
for (col in colnames(ctNorm)){
print(col)
}
for (col in colnames(ctNorm)){
if(is.na(ctNorm$col)){
print(col)
}
}
is.na(ctNorm$CCR3)
is.na(ctNorm$CD274)
sum(is.na(ctNorm$CD274))
for (col in colnames(ctNorm)){
if(sum(is.na(ctNorm$col))>0){
print(col)
}
}
for (col in colnames(ctNorm)){
print(sum(is.na(ctNorm$col)))
# if(sum(is.na(ctNorm$col))>0){
#   print(col)
# }
}
ctNorm$cellSource
for (col in colnames(ctNorm)){
print(ctNorm$col)
# if(sum(is.na(ctNorm$col))>0){
#   print(col)
# }
}
for (col in colnames(ctNorm)){
ctNorm[col, ]
# if(sum(is.na(ctNorm$col))>0){
#   print(col)
# }
}
for (col in colnames(ctNorm)){
print(ctNorm[col, ])
# if(sum(is.na(ctNorm$col))>0){
#   print(col)
# }
}
for (col in colnames(ctNorm)){
print(is.na(ctNorm[col, ]))
# if(sum(is.na(ctNorm$col))>0){
#   print(col)
# }
}
for (col in colnames(ctNorm)){
print(sum(is.na(ctNorm[col, ])))
# if(sum(is.na(ctNorm$col))>0){
#   print(col)
# }
}
for (col in colnames(ctNorm)){
print(sum(is.na(ctNorm[,col])))
# if(sum(is.na(ctNorm$col))>0){
#   print(col)
# }
}
for (col in colnames(ctNorm)){
if(sum(is.na(ctNorm[,col])))>0){
for (col in colnames(ctNorm)){
if(sum(is.na(ctNorm[,col])) > 0){
print(col)
}
}
for (col in colnames(ctNorm)){
na <- sum(is.na(ctNorm[,col]))
if(na > 0){
result <- cat("column ", col, " have ", na, " NA")
print(result)
}
}
for (col in colnames(ctNorm)){
na <- sum(is.na(ctNorm[,col]))
if(na > 0){
result <- cat("column ", col, " have ", na, " NA", \n)
for (col in colnames(ctNorm)){
na <- sum(is.na(ctNorm[,col]))
if(na > 0){
result <- cat("column ", col, " have ", na, " NA", "\n")
print(result)
}
}
for (col in colnames(ctNorm)){
na <- sum(is.na(ctNorm[,col]))
if(na > 0){
result <- cat("column ", col, " have ", na, " NA")
print(result)
}
}
for (col in colnames(ctNorm)){
na <- sum(is.na(ctNorm[,col]))
if(na > 0){
result <- cat("column ", col, " have ", na, " NA")
print(result)
}
}
## load data
ctTable <- dataLoadT1D()
knitr::opts_knit$set(global.par = TRUE)
library(plyr)
library(ggplot2)
library(RColorBrewer)
library(reshape2)
library(gplots)
library(gtools)
library(stats)
library(lattice)
library(latticeExtra)
library(grid)
library(gridExtra)
library(wesanderson)
library(Rtsne)
## set baseDir if Knitting with RStudio button
baseDir <- "~/Desktop/Su Lab/single_cell_T1D/"
## sets path if run from runAnalysis.R
#currentFile <- rstudioapi::getActiveDocumentContext()$path
#baseDir <- gsub("single_cell_T1D/.*", "single_cell_T1D/", currentFile)
#### source function scripts ####
funcDir <- paste(baseDir, "src/functions/", sep="")
funcFiles <- c("formatRaw.R",
"dataLoadT1D.R",
"cleanCt.R",
"geneSetEnrichment.R",
"violinPlot.R",
"heatmap2_custom.R",
"heatmap.3.R",
"clusterFilter.R",
"tableBarPlots.R",
"clusterReport.R",
"reportViolins.R",
"reportTSNE.R",
"plotTSNE.R")
funcFiles <- paste(funcDir, funcFiles, sep="")
for(file in funcFiles){
source(file)
}
## load data
ctTable <- dataLoadT1D()
for (col in rownames(ctTable)){
na <- sum(is.na(ctTable[col, ]))
if(na > 0){
result <- cat("column ", col, " have ", na, " NA")
print(result)
}
}
View(ctTable)
ctTest <- subset(ctTable, select = -Comments)
for (col in rownames(ctTest)){
na <- sum(is.na(ctTest[col, ]))
if(na > 0){
result <- cat("column ", col, " have ", na, " NA")
print(result)
}
}
ctTest <- subset(ctTable, select = -Comments)
for (col in rownames(ctTest)){
na <- sum(is.na(ctTest[col, ]))
if(na > 0){
result <- cat("column ", col, " have ", na, " NA")
print(result)
}
}
ctTest <- subset(ctTable, select = -c("Comments", "probe", "cellSource", "age"))
ctTest <- subset(ctTable, drop = c("Comment", "age", "probe", "cellSource"))
ctTest <- subset(ctTable, select = -c(Comment, age, cellSource, probe))
ctTest <- subset(ctTable, select = -c(Comments, age, cellSource, probe))
ctTest <- subset(ctTable, select = -c(Comments, age, cellSource, probe))
for (col in rownames(ctTest)){
na <- sum(is.na(ctTest[col, ]))
if(na > 0){
result <- cat("column ", col, " have ", na, " NA")
print(result)
}
}
